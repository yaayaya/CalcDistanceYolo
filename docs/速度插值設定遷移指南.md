# é€Ÿåº¦æ’å€¼è¨­å®šé·ç§»æŒ‡å—

## ğŸ“‹ è®Šæ›´æ‘˜è¦

**æ—¥æœŸ**: 2025-11-09  
**ç‰ˆæœ¬**: v2.0  
**è®Šæ›´é¡å‹**: UI é‡çµ„èˆ‡åŠŸèƒ½æ•´åˆ

### ä¸»è¦è®Šæ›´

1. **é€Ÿåº¦æ’å€¼è¨­å®šä½ç½®è®Šæ›´**
   - **åŸä½ç½®**: `frontend/index.html` (ç®¡ç†å¾Œå°ç›£æ§ä»‹é¢)
   - **æ–°ä½ç½®**: `frontend/admin.html` (å¾Œå°ç®¡ç†ä»‹é¢) â†’ è·é›¢åµæ¸¬æ ¡æº–åˆ†é 
   
2. **è·é›¢åµæ¸¬æ ¡æº–å€æ®µé‡æ–°è¨­è¨ˆ**
   - æ•´åˆé€Ÿåº¦æ§åˆ¶æ¨¡å¼é¸æ“‡
   - æ–°å¢ä¸‰é»æ’å€¼è¦–è¦ºåŒ–è¨­å®šå€å¡Š
   - ä¿ç•™å‚³çµ±é›™é»ç·šæ€§æ¨¡å¼ä½œç‚ºå‚™é¸

3. **ç¨‹å¼ç¢¼æ¶æ§‹å„ªåŒ–**
   - ç§»é™¤ `script.js` ä¸­çš„é€Ÿåº¦æ’å€¼è™•ç†é‚è¼¯
   - çµ±ä¸€ä½¿ç”¨ Vue.js ç®¡ç† admin.html çš„æ‰€æœ‰äº’å‹•
   - ç°¡åŒ– index.html ç‚ºç´”ç›£æ§ä»‹é¢

---

## ğŸ¯ æ–°åŠŸèƒ½ä½ç½®

### Admin.html - è·é›¢åµæ¸¬æ ¡æº–åˆ†é 

é–‹å•Ÿè·¯å¾‘: `http://localhost:8000/admin.html` â†’ é»é¸å·¦å´é¸å–®ã€Œ**è·é›¢åµæ¸¬æ ¡æº–**ã€

#### 1ï¸âƒ£ é€Ÿåº¦æ§åˆ¶æ¨¡å¼å€æ®µ

```
ğŸ“ˆ é€Ÿåº¦æ§åˆ¶æ¨¡å¼
â˜‘ å•Ÿç”¨ä¸‰é»æ’å€¼æ¨¡å¼
â””â”€ å•Ÿç”¨å¾Œä½¿ç”¨ä¸‰å€‹è·é›¢é»é€²è¡Œç·šæ€§æ’å€¼,åœç”¨å‰‡ä½¿ç”¨å‚³çµ±é›™é»ç·šæ€§æ¨¡å¼
```

**ä½œç”¨**:
- **å‹¾é¸**: ä½¿ç”¨ä¸‰é»æ’å€¼,æä¾›æ›´ç²¾ç´°çš„é€Ÿåº¦æ§åˆ¶
- **å–æ¶ˆå‹¾é¸**: å›åˆ°å‚³çµ±é›™é»ç·šæ€§æ¨¡å¼ (minDistance â†” maxDistance)

---

#### 2ï¸âƒ£ ä¸‰é»æ’å€¼è¨­å®šå€æ®µ (å•Ÿç”¨æ™‚é¡¯ç¤º)

```
ğŸ¯ é€Ÿåº¦æ’å€¼é»è¨­å®š

é» 1 - è·é›¢ (æœ€è¿‘): 130 cm  |  é» 1 - é€Ÿåº¦: 8.0 x
é» 2 - è·é›¢ (ä¸­é–“): 150 cm  |  é» 2 - é€Ÿåº¦: 3.0 x
é» 3 - è·é›¢ (æœ€é ): 170 cm  |  é» 3 - é€Ÿåº¦: 0.5 x

âš ï¸ è­¦å‘Š: è·é›¢é»å¿…é ˆç”±å°åˆ°å¤§æ’åˆ—,è«‹èª¿æ•´æ•¸å€¼
```

**è¨­å®šèªªæ˜**:
- **é» 1** (ç´…è‰²): æœ€è¿‘è·é›¢ â†’ å°æ‡‰æœ€å¤§é€Ÿåº¦ (é€šå¸¸ 8.0x)
- **é» 2** (æ©˜è‰²): ä¸­é–“è·é›¢ â†’ å°æ‡‰ä¸­ç­‰é€Ÿåº¦ (é€šå¸¸ 3.0x)
- **é» 3** (è—è‰²): æœ€é è·é›¢ â†’ å°æ‡‰æœ€å°é€Ÿåº¦ (é€šå¸¸ 0.5x)

**é©—è­‰è¦å‰‡**:
- å¿…é ˆæ»¿è¶³: `è·é›¢1 < è·é›¢2 < è·é›¢3`
- é•åæ™‚æœƒé¡¯ç¤ºç´…è‰²è­¦å‘Šè¨Šæ¯
- å„²å­˜æ™‚æœƒé€²è¡ŒäºŒæ¬¡é©—è­‰,ä¸ç¬¦åˆå‰‡æ‹’çµ•å„²å­˜

---

#### 3ï¸âƒ£ å‚³çµ±é›™é»æ¨¡å¼è¨­å®šå€æ®µ (åœç”¨æ’å€¼æ™‚é¡¯ç¤º)

```
ğŸ“Š å‚³çµ±é›™é»ç·šæ€§æ¨¡å¼

æœ€å°è·é›¢ (minDistance): 130 cm
â””â”€ è§¸ç™¼æœ€å¤§é€Ÿåº¦çš„æœ€è¿‘è·é›¢

æœ€å¤§è·é›¢ (maxDistance): 170 cm
â””â”€ è§¸ç™¼åŸºç¤é€Ÿåº¦çš„æœ€é è·é›¢
```

**é‹ä½œåŸç†**:
- åœ¨ minDistance ~ maxDistance ç¯„åœå…§ç·šæ€§æ’å€¼
- å°æ–¼ minDistance â†’ é–å®šç‚º maxSpeed
- å¤§æ–¼ maxDistance â†’ é–å®šç‚º baseSpeed

---

#### 4ï¸âƒ£ é€²éšåµæ¸¬åƒæ•¸

ä¿ç•™åŸæœ‰åƒæ•¸:
- è·é›¢è®ŠåŒ–é–¾å€¼
- å¹³æ»‘ä¿‚æ•¸
- å•Ÿå‹•/åœç”¨å»¶é²
- ç„¡äººè‡‰é€¾æ™‚
- å¤šäººæ¨¡å¼é¸æ“‡

---

## ğŸ› ï¸ æŠ€è¡“å¯¦ä½œç´°ç¯€

### 1. HTML çµæ§‹è®Šæ›´

#### admin.html æ–°å¢å…§å®¹

```html
<!-- é€Ÿåº¦æ§åˆ¶æ¨¡å¼é¸æ“‡ -->
<div class="form-group" style="background: #f0f9ff; padding: 15px;">
    <h3>ğŸ“ˆ é€Ÿåº¦æ§åˆ¶æ¨¡å¼</h3>
    <label class="checkbox-label">
        <input type="checkbox" v-model="config.speedInterpolation.enabled" @change="onModeChange">
        å•Ÿç”¨ä¸‰é»æ’å€¼æ¨¡å¼
    </label>
</div>

<!-- ä¸‰é»æ’å€¼è¨­å®š (æ¢ä»¶é¡¯ç¤º) -->
<div v-show="config.speedInterpolation.enabled">
    <!-- é» 1 -->
    <input v-model.number="config.speedInterpolation.points[0].distance">
    <input v-model.number="config.speedInterpolation.points[0].speed">
    
    <!-- é» 2 -->
    <input v-model.number="config.speedInterpolation.points[1].distance">
    <input v-model.number="config.speedInterpolation.points[1].speed">
    
    <!-- é» 3 -->
    <input v-model.number="config.speedInterpolation.points[2].distance">
    <input v-model.number="config.speedInterpolation.points[2].speed">
</div>

<!-- é©—è­‰æç¤º -->
<div v-if="!validateInterpolationPoints()" class="info-box">
    âš ï¸ è­¦å‘Š: è·é›¢é»å¿…é ˆç”±å°åˆ°å¤§æ’åˆ—
</div>
```

---

### 2. Vue.js è³‡æ–™æ¨¡å‹

```javascript
data() {
    return {
        config: {
            video: {
                speedControlMode: 'interpolation'  // æ–°å¢
            },
            speedInterpolation: {  // æ–°å¢çµæ§‹
                enabled: true,
                points: [
                    { distance: 130, speed: 8.0 },
                    { distance: 150, speed: 3.0 },
                    { distance: 170, speed: 0.5 }
                ]
            },
            distance: { /* åŸæœ‰è¨­å®š */ }
        }
    };
}
```

---

### 3. æ ¸å¿ƒæ–¹æ³•

#### onModeChange()
```javascript
onModeChange() {
    // åŒæ­¥æ›´æ–° speedControlMode
    this.config.video.speedControlMode = 
        this.config.speedInterpolation.enabled ? 'interpolation' : 'linear';
    this.config.video.transitionTime = 0;  // ç¢ºä¿å³æ™‚åˆ‡æ›
}
```

#### validateInterpolationPoints()
```javascript
validateInterpolationPoints() {
    const p1 = this.config.speedInterpolation.points[0].distance;
    const p2 = this.config.speedInterpolation.points[1].distance;
    const p3 = this.config.speedInterpolation.points[2].distance;
    return p1 < p2 && p2 < p3;
}
```

#### saveConfig() (å¢å¼·ç‰ˆ)
```javascript
async saveConfig() {
    // å„²å­˜å‰é©—è­‰
    if (this.config.speedInterpolation.enabled && 
        !this.validateInterpolationPoints()) {
        this.showMessage('é€Ÿåº¦æ’å€¼é»è·é›¢å¿…é ˆç”±å°åˆ°å¤§æ’åˆ—', 'error');
        return;
    }

    const configToSave = {
        video: this.config.video,
        speedInterpolation: this.config.speedInterpolation,  // æ–°å¢
        distance: this.config.distance,
        display: this.config.display
    };
    
    await apiClient.updateConfig(configToSave);
}
```

---

### 4. script.js ç°¡åŒ–

**ç§»é™¤çš„å‡½å¼**:
- `loadSpeedInterpolationConfig()`
- `saveSpeedInterpolationConfig()`

**ç§»é™¤çš„äº‹ä»¶ç¶å®š**:
```javascript
// å·²ç§»é™¤
document.getElementById('speed-interpolation-form')
    .addEventListener('submit', saveSpeedInterpolationConfig);
```

**ä¿ç•™åŠŸèƒ½**:
- WebSocket é€£ç·šç®¡ç†
- ç¶²è·¯é…ç½®ç®¡ç†
- å³æ™‚ç›£æ§æ›´æ–°

---

## ğŸ“Š è¨­å®šæª”æ ¼å¼

### project_config.json

```json
{
  "video": {
    "speedControlMode": "interpolation",  // "interpolation" æˆ– "linear"
    "transitionTime": 0,                  // å³æ™‚åˆ‡æ›
    "maxSpeed": 8.0,
    "minSpeed": 0.25
  },
  "speedInterpolation": {
    "enabled": true,
    "points": [
      { "distance": 130, "speed": 8.0 },  // é» 1: æœ€è¿‘
      { "distance": 150, "speed": 3.0 },  // é» 2: ä¸­é–“
      { "distance": 170, "speed": 0.5 }   // é» 3: æœ€é 
    ]
  },
  "distance": {
    "minDistance": 130,       // å‚³çµ±æ¨¡å¼ç”¨
    "maxDistance": 170,       // å‚³çµ±æ¨¡å¼ç”¨
    "closestPersonMode": true,
    "distanceThreshold": 3,
    "smoothingFactor": 0.5
  }
}
```

---

## ğŸ”„ ä½¿ç”¨æµç¨‹

### æ–¹å¼ A: ä½¿ç”¨ä¸‰é»æ’å€¼æ¨¡å¼ (æ¨è–¦)

1. é–‹å•Ÿ `http://localhost:8000/admin.html`
2. é»é¸å·¦å´ã€Œ**è·é›¢åµæ¸¬æ ¡æº–**ã€åˆ†é 
3. ç¢ºèªã€Œ**å•Ÿç”¨ä¸‰é»æ’å€¼æ¨¡å¼**ã€å·²å‹¾é¸
4. è¨­å®šä¸‰å€‹æ’å€¼é»:
   - **é» 1** (æœ€è¿‘): ä¾‹å¦‚ 130 cm â†’ 8.0x
   - **é» 2** (ä¸­é–“): ä¾‹å¦‚ 150 cm â†’ 3.0x
   - **é» 3** (æœ€é ): ä¾‹å¦‚ 170 cm â†’ 0.5x
5. ç¢ºèªç„¡ç´…è‰²è­¦å‘Šè¨Šæ¯
6. é»æ“Šå³ä¸Šè§’ã€Œ**å„²å­˜è¨­å®š**ã€æŒ‰éˆ•
7. ç­‰å¾…ç¶ è‰²æˆåŠŸæç¤º
8. é–‹å•Ÿ `player.html` æ¸¬è©¦æ•ˆæœ

### æ–¹å¼ B: ä½¿ç”¨å‚³çµ±é›™é»æ¨¡å¼

1. é–‹å•Ÿ admin.html â†’ è·é›¢åµæ¸¬æ ¡æº–åˆ†é 
2. **å–æ¶ˆå‹¾é¸**ã€Œå•Ÿç”¨ä¸‰é»æ’å€¼æ¨¡å¼ã€
3. è¨­å®šæœ€å°è·é›¢ (ä¾‹å¦‚ 130 cm)
4. è¨­å®šæœ€å¤§è·é›¢ (ä¾‹å¦‚ 170 cm)
5. å„²å­˜è¨­å®š
6. ç³»çµ±è‡ªå‹•ä½¿ç”¨ minDistance â†” maxDistance ç·šæ€§æ’å€¼

---

## ğŸ§ª æ¸¬è©¦é©—è­‰

### æ¸¬è©¦é …ç›® 1: UI é¡¯ç¤ºåˆ‡æ›

- [ ] å‹¾é¸ã€Œå•Ÿç”¨ä¸‰é»æ’å€¼ã€â†’ é¡¯ç¤ºä¸‰é»è¨­å®šå€å¡Š
- [ ] å–æ¶ˆå‹¾é¸ â†’ é¡¯ç¤ºé›™é»è¨­å®šå€å¡Š
- [ ] åˆ‡æ›æ™‚ç„¡æ§åˆ¶å°éŒ¯èª¤

### æ¸¬è©¦é …ç›® 2: é©—è­‰åŠŸèƒ½

- [ ] è¨­å®šéŒ¯èª¤é †åº (ä¾‹å¦‚ 170, 150, 130) â†’ é¡¯ç¤ºç´…è‰²è­¦å‘Š
- [ ] è¨­å®šæ­£ç¢ºé †åº (130, 150, 170) â†’ è­¦å‘Šæ¶ˆå¤±
- [ ] å„²å­˜éŒ¯èª¤é †åº â†’ æ‹’çµ•å„²å­˜ä¸¦é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯

### æ¸¬è©¦é …ç›® 3: è³‡æ–™æŒä¹…åŒ–

- [ ] å„²å­˜ä¸‰é»æ’å€¼è¨­å®š â†’ é‡æ–°æ•´ç†é é¢ â†’ è¨­å®šæ­£ç¢ºè¼‰å…¥
- [ ] åˆ‡æ›åˆ°é›™é»æ¨¡å¼ä¸¦å„²å­˜ â†’ é‡æ–°æ•´ç† â†’ æ¨¡å¼æ­£ç¢ºé¡¯ç¤º
- [ ] æª¢æŸ¥ `project_config.json` æ˜¯å¦æ­£ç¢ºæ›´æ–°

### æ¸¬è©¦é …ç›® 4: æ’­æ”¾æ•ˆæœé©—è­‰

**ä¸‰é»æ’å€¼æ¨¡å¼**:
```
åµæ¸¬è·é›¢ 120 cm â†’ é€Ÿåº¦ 8.0x  (å°æ–¼é»1,é–å®šç‚ºé»1é€Ÿåº¦)
åµæ¸¬è·é›¢ 130 cm â†’ é€Ÿåº¦ 8.0x  (é»1)
åµæ¸¬è·é›¢ 140 cm â†’ é€Ÿåº¦ 5.5x  (é»1èˆ‡é»2ä¹‹é–“æ’å€¼)
åµæ¸¬è·é›¢ 150 cm â†’ é€Ÿåº¦ 3.0x  (é»2)
åµæ¸¬è·é›¢ 160 cm â†’ é€Ÿåº¦ 1.75x (é»2èˆ‡é»3ä¹‹é–“æ’å€¼)
åµæ¸¬è·é›¢ 170 cm â†’ é€Ÿåº¦ 0.5x  (é»3)
åµæ¸¬è·é›¢ 180 cm â†’ é€Ÿåº¦ 0.5x  (å¤§æ–¼é»3,é–å®šç‚ºé»3é€Ÿåº¦)
```

**é©—è­‰æ–¹æ³•**:
1. é–‹å•Ÿ player.html ä¸¦å•Ÿç”¨é™¤éŒ¯æ¨¡å¼ (Ctrl+Shift+D)
2. è§€å¯Ÿç•«é¢ä¸Šçš„ã€Œåµæ¸¬è·é›¢ã€å’Œã€Œæ’­æ”¾é€Ÿåº¦ã€æ•¸å€¼
3. æ‰‹å‹•é è¿‘/é é›¢æ”å½±æ©Ÿ
4. é©—è­‰é€Ÿåº¦è®ŠåŒ–æ˜¯å¦ç¬¦åˆä¸Šè¿°æ’å€¼é‚è¼¯

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- **åŸå§‹å¯¦ä½œæ–‡ä»¶**: `docs/projectDoc/DistanceVideo_å¯¦ä½œæ‘˜è¦.md`
- **å¿«é€Ÿå•Ÿå‹•æŒ‡å—**: `docs/å¿«é€Ÿå•Ÿå‹•.md`
- **æ¸¬è©¦é é¢**: `frontend/test-interpolation.html` (å·²å»¢æ£„,åŠŸèƒ½æ•´åˆè‡³ admin.html)
- **API èªªæ˜**: `http://localhost:8000/docs` (FastAPI è‡ªå‹•æ–‡ä»¶)

---

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1: å„²å­˜å¾Œè¨­å®šæœªç”Ÿæ•ˆ

**ç¾è±¡**: é»æ“Šå„²å­˜å¾Œ,player.html æ’­æ”¾é€Ÿåº¦æœªæ”¹è®Š

**è§£æ±ºæ–¹æ³•**:
1. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°æ˜¯å¦æœ‰ API éŒ¯èª¤
2. ç¢ºèª `GET /api/admin/config` å›æ‡‰åŒ…å«æœ€æ–°è¨­å®š
3. å¼·åˆ¶é‡æ–°æ•´ç† player.html (Ctrl+F5)
4. æª¢æŸ¥ `project_config.json` æª”æ¡ˆå…§å®¹

### å•é¡Œ 2: é©—è­‰è­¦å‘Šä¸æ¶ˆå¤±

**ç¾è±¡**: è¨­å®šæ­£ç¢ºé †åºå¾Œä»é¡¯ç¤ºç´…è‰²è­¦å‘Š

**è§£æ±ºæ–¹æ³•**:
1. ç¢ºèªè·é›¢å€¼ç‚ºç´”æ•¸å­— (éå­—ä¸²)
2. æª¢æŸ¥æ˜¯å¦å­˜åœ¨å°æ•¸é»èª¤å·®
3. å˜—è©¦é‡æ–°è¼¸å…¥æ•¸å€¼
4. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å° Vue éŒ¯èª¤è¨Šæ¯

### å•é¡Œ 3: admin.html ç„¡æ³•è¼‰å…¥è¨­å®š

**ç¾è±¡**: æ‰“é–‹ admin.html æ‰€æœ‰æ¬„ä½ç‚ºç©ºæˆ–é è¨­å€¼

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. æª¢æŸ¥ API ç«¯é»
curl http://localhost:8000/api/admin/config

# 2. æª¢æŸ¥è¨­å®šæª”
cat backend/configs/project_config.json

# 3. é‡å•Ÿå¾Œç«¯æœå‹™
cd backend
python main.py
```

---

## âœ… é·ç§»æª¢æŸ¥æ¸…å–®

### å‰ç«¯æª”æ¡ˆ
- [x] `frontend/admin.html` - æ–°å¢é€Ÿåº¦æ’å€¼ UI
- [x] `frontend/index.html` - ç§»é™¤é€Ÿåº¦æ’å€¼å€æ®µ
- [x] `frontend/script.js` - ç§»é™¤ç›¸é—œå‡½å¼å’Œäº‹ä»¶ç¶å®š

### å¾Œç«¯æª”æ¡ˆ
- [x] `backend/configs/project_config.json` - å·²åŒ…å« speedInterpolation å€å¡Š
- [x] `backend/app/api/admin_api.py` - æ”¯æ´æ·±å±¤åˆä½µæ›´æ–° (ç„¡éœ€ä¿®æ”¹)

### æ¸¬è©¦é©—è­‰
- [ ] admin.html å¯æ­£å¸¸è¼‰å…¥è¨­å®š
- [ ] ä¸‰é»æ’å€¼æ¨¡å¼å¯æ­£å¸¸å„²å­˜
- [ ] é›™é»æ¨¡å¼å¯æ­£å¸¸å„²å­˜
- [ ] é©—è­‰åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] player.html é€Ÿåº¦è®ŠåŒ–ç¬¦åˆè¨­å®š

### æ–‡ä»¶æ›´æ–°
- [x] å»ºç«‹é·ç§»æŒ‡å— (æœ¬æ–‡ä»¶)
- [ ] æ›´æ–°å¿«é€Ÿå•Ÿå‹•æŒ‡å— (è‹¥æœ‰æåŠ index.html è¨­å®š)
- [ ] æ›´æ–°ä½¿ç”¨è€…æ‰‹å†Š (è‹¥æœ‰)

---

## ğŸ“ å‚™è¨»

1. **å‘ä¸‹ç›¸å®¹æ€§**: 
   - èˆŠç‰ˆ project_config.json ç¼ºå°‘ speedInterpolation æ™‚,ç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨é è¨­å€¼
   - å‚³çµ±é›™é»æ¨¡å¼ä»å®Œå…¨ä¿ç•™,å¯éš¨æ™‚åˆ‡æ›

2. **æ•ˆèƒ½å½±éŸ¿**: 
   - ä¸‰é»æ’å€¼å¢åŠ çš„é‹ç®—é‡å¾®ä¹å…¶å¾®
   - å³æ™‚åˆ‡æ› (transitionTime: 0) ç„¡æ€§èƒ½è² æ“”

3. **æœªä¾†æ“´å……**: 
   - å¯æ“´å……è‡³ N é»æ’å€¼ (éœ€ä¿®æ”¹å‰ç«¯è¡¨å–®å’Œé©—è­‰é‚è¼¯)
   - å¯æ–°å¢æ›²ç·šæ’å€¼æ¨¡å¼ (ä¾‹å¦‚æ¨£æ¢æ’å€¼)
   - å¯æ–°å¢é è¨­çµ„åˆ (å±•ç¤ºæ¨¡å¼ã€äº’å‹•æ¨¡å¼ç­‰)

---

**æ–‡ä»¶ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025-11-09  
**ç¶­è­·è€…**: GitHub Copilot
