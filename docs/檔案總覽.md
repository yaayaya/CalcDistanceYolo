# ğŸ“‹ å°ˆæ¡ˆæª”æ¡ˆç¸½è¦½

å¿«é€Ÿç€è¦½å°ˆæ¡ˆä¸­æ‰€æœ‰é‡è¦æª”æ¡ˆåŠå…¶ç”¨é€”ã€‚

## ğŸ—‚ï¸ æ ¹ç›®éŒ„æª”æ¡ˆ

| æª”æ¡ˆ | ç”¨é€” | èªªæ˜ |
|------|------|------|
| `README.md` | å°ˆæ¡ˆç°¡ä»‹ | ç²¾ç°¡çš„å°ˆæ¡ˆä»‹ç´¹å’Œå¿«é€Ÿé–‹å§‹æŒ‡å— |
| `requirements.txt` | Python ä¾è³´ | å°ˆæ¡ˆæ‰€éœ€çš„ Python å¥—ä»¶æ¸…å–® |
| `run.py` | å•Ÿå‹•è…³æœ¬ | Python å•Ÿå‹•è…³æœ¬ (æ¨è–¦ä½¿ç”¨) |
| `run.bat` | æ‰¹æ¬¡æª” | Windows é›™æ“Šå•Ÿå‹•è…³æœ¬ |
| `clean.bat` | æ¸…ç†è…³æœ¬ | æ¸…ç† `__pycache__` å’Œ `.pyc` æª”æ¡ˆ |
| `.gitignore` | Git è¨­å®š | å¿½ç•¥ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶çš„æª”æ¡ˆ |
| `.gitattributes` | Git è¨­å®š | Git å±¬æ€§è¨­å®š |

## ğŸ“ backend/ - å¾Œç«¯æœå‹™

### ä¸»è¦æª”æ¡ˆ

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `main.py` | FastAPI æ‡‰ç”¨é€²å…¥é»,å®šç¾©è·¯ç”±å’Œç”Ÿå‘½é€±æœŸ |
| `sensor_config.json` | æ„Ÿæ¸¬å™¨èˆ‡ YOLO æ¨¡å‹è¨­å®š (ç”± GUI å·¥å…·ä¿®æ”¹) |
| `config.json` | èˆŠè¨­å®šæª” (å·²æ£„ç”¨,ä¿ç•™ç›¸å®¹æ€§) |

### app/api/ - API è·¯ç”±

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `websocket.py` | WebSocket è·¯ç”± (`/ws/detection`, `/ws/live`) |
| `frontend.py` | RESTful API è·¯ç”± (`/api/*`) |

### app/models/ - è³‡æ–™æ¨¡å‹

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `schemas.py` | Pydantic è³‡æ–™æ¨¡å‹å®šç¾© (è«‹æ±‚/å›æ‡‰æ ¼å¼) |

### app/services/ - æ ¸å¿ƒæœå‹™

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `detector.py` | YOLO åµæ¸¬æœå‹™,è² è²¬å½±åƒè¾¨è­˜ |
| `calculator.py` | è·é›¢è¨ˆç®—æœå‹™,æ ¹æ“šåµæ¸¬çµæœè¨ˆç®—è·é›¢ |
| `connection_manager.py` | WebSocket é€£ç·šç®¡ç†,å»£æ’­è³‡æ–™çµ¦å®¢æˆ¶ç«¯ |

### app/utils/ - å·¥å…·å‡½å¼

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `config_loader.py` | è¨­å®šæª”è¼‰å…¥å™¨,è®€å– JSON è¨­å®š |

### configs/ - ç¶²è·¯è¨­å®š

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `network_config.json` | WebSocket ç¶²è·¯è¨­å®š (å¯é€é API ä¿®æ”¹) |

## ğŸ¨ frontend/ - å‰ç«¯ä»‹é¢

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `index.html` | ç®¡ç†å¾Œå°ä¸»é  HTML |
| `script.js` | JavaScript ç¨‹å¼ç¢¼ (WebSocket é€£ç·šã€API è«‹æ±‚) |
| `style.css` | æ¨£å¼è¡¨ |

## ğŸ¤– models/ - AI æ¨¡å‹

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `yolo11n.pt` | YOLO11n æ¨¡å‹æ¬Šé‡æª”æ¡ˆ |

## ğŸ› ï¸ tools/ - è¼”åŠ©å·¥å…·

### tools/åŸºæœ¬åµæ¸¬/

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `camera_test_gui_v2.py` | ç„¦è·æ ¡æº– GUI å·¥å…· |
| `sensor_configè¨»è§£.json` | è¨­å®šæª”ç¯„ä¾‹èˆ‡è¨»è§£èªªæ˜ |

## ğŸ“š docs/ - å°ˆæ¡ˆæ–‡ä»¶

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `åŸå§‹README.md` | å®Œæ•´çš„æŠ€è¡“æ–‡ä»¶å’Œ API èªªæ˜ |
| `å¿«é€Ÿå•Ÿå‹•.md` | å¿«é€Ÿéƒ¨ç½²æŒ‡å— |
| `è¦åŠƒ.md` | å°ˆæ¡ˆè¦åŠƒèˆ‡éœ€æ±‚æ–‡ä»¶ |
| `å°ˆæ¡ˆçµæ§‹.md` | è©³ç´°çš„ç›®éŒ„çµæ§‹èªªæ˜ |
| `é·ç§»æŒ‡å—.md` | å¾èˆŠçµæ§‹é·ç§»çš„æ­¥é©Ÿ |
| `é‡çµ„å®Œæˆæ‘˜è¦.md` | ç›®éŒ„é‡çµ„å®Œæˆå ±å‘Š |
| `æª”æ¡ˆç¸½è¦½.md` | æœ¬æª”æ¡ˆ |

## ğŸ“Š é‡è¦è¨­å®šæª”è©³è§£

### sensor_config.json

**ä½ç½®:** `backend/sensor_config.json`  
**ä¿®æ”¹æ–¹å¼:** é€é `tools/åŸºæœ¬åµæ¸¬/camera_test_gui_v2.py`

```json
{
  "model": {
    "model_path": "yolo11n.pt",     // æ¨¡å‹æª”æ¡ˆåç¨±
    "imgsz": 416,                   // è¼¸å…¥å½±åƒå¤§å°
    "conf": 0.5,                    // ä¿¡å¿ƒåº¦é–¾å€¼
    "iou": 0.5,                     // IoU é–¾å€¼
    "device": "cpu",                // åŸ·è¡Œè£ç½® (cpu/cuda)
    "vid_stride": 3,                // è·³å¹€æ•¸
    "tracker": "botsort.yaml"       // è¿½è¹¤å™¨
  },
  "distance": {
    "focal_length": 600,            // ç„¦è· (éœ€æ ¡æº–)
    "real_person_height": 170,      // é è¨­äººé«”é«˜åº¦ (cm)
    "use_adaptive_height": true,    // ä½¿ç”¨è‡ªé©æ‡‰é«˜åº¦
    "use_smoothing": true,          // ä½¿ç”¨å¹³æ»‘åŒ–
    "smoothing_window": 5           // å¹³æ»‘çª—å£å¤§å°
  },
  "camera": {
    "source": 0,                    // æ”å½±æ©Ÿä¾†æº (0=é è¨­)
    "width": 640,                   // è§£æåº¦å¯¬åº¦
    "height": 480                   // è§£æåº¦é«˜åº¦
  }
}
```

### network_config.json

**ä½ç½®:** `backend/configs/network_config.json`  
**ä¿®æ”¹æ–¹å¼:** é€éå¾Œå° API (`PUT /api/network-config`)

```json
{
  "websocket": {
    "host": "0.0.0.0",              // WebSocket ä¸»æ©Ÿ
    "port": 8000,                   // åŸ è™Ÿ
    "broadcast_interval": 33        // å»£æ’­é–“éš” (ms, 33 â‰ˆ 30 FPS)
  }
}
```

## ğŸš€ å¸¸ç”¨æ“ä½œå°ç…§

### å•Ÿå‹•æœå‹™

| æ“ä½œ | æŒ‡ä»¤/æª”æ¡ˆ |
|------|----------|
| æ¨è–¦æ–¹å¼ | `python run.py` æˆ–é›™æ“Š `run.bat` |
| å‚³çµ±æ–¹å¼ | `cd backend; python main.py` |
| Uvicorn | `cd backend; uvicorn main:app --reload` |

### æ ¡æº–ç„¦è·

| æ“ä½œ | æŒ‡ä»¤ |
|------|------|
| å•Ÿå‹• GUI å·¥å…· | `cd tools\åŸºæœ¬åµæ¸¬; python camera_test_gui_v2.py` |
| ä¿®æ”¹çš„æª”æ¡ˆ | `backend/sensor_config.json` |
| å¥—ç”¨è®Šæ›´ | åœ¨å¾Œå°é»æ“Šã€Œé‡å•Ÿåµæ¸¬å™¨ã€æˆ–å‘¼å« `POST /api/detector/refresh` |

### å­˜å–æœå‹™

| æœå‹™ | URL |
|------|-----|
| ç®¡ç†å¾Œå° | http://localhost:8000/admin |
| API æ–‡ä»¶ | http://localhost:8000/docs |
| å¥åº·æª¢æŸ¥ | http://localhost:8000/health |
| WebSocket (å®Œæ•´) | ws://localhost:8000/ws/detection |
| WebSocket (ç°¡åŒ–) | ws://localhost:8000/ws/live |

### æ¸…ç†å¿«å–

| æ“ä½œ | æŒ‡ä»¤/æª”æ¡ˆ |
|------|----------|
| é›™æ“ŠåŸ·è¡Œ | `clean.bat` |
| PowerShell | `Get-ChildItem -Recurse -Filter "__pycache__" \| Remove-Item -Recurse -Force` |

## ğŸ“¦ ä¾è³´å¥—ä»¶

**æª”æ¡ˆ:** `requirements.txt`

ä¸»è¦å¥—ä»¶:
- `fastapi` - Web æ¡†æ¶
- `uvicorn` - ASGI ä¼ºæœå™¨
- `ultralytics` - YOLO æ¨¡å‹
- `opencv-python` - å½±åƒè™•ç†
- `numpy` - æ•¸å€¼é‹ç®—
- `python-multipart` - æª”æ¡ˆä¸Šå‚³æ”¯æ´

## ğŸ” å¿«é€ŸæŸ¥æ‰¾

### æƒ³ä¿®æ”¹å‰ç«¯ä»‹é¢?
â†’ ç·¨è¼¯ `frontend/index.html`, `frontend/script.js`, `frontend/style.css`

### æƒ³èª¿æ•´ YOLO æ¨¡å‹åƒæ•¸?
â†’ ä½¿ç”¨ `tools/åŸºæœ¬åµæ¸¬/camera_test_gui_v2.py` ä¿®æ”¹ `backend/sensor_config.json`

### æƒ³ä¿®æ”¹ WebSocket å»£æ’­é »ç‡?
â†’ åœ¨å¾Œå°ä»‹é¢ä¿®æ”¹æˆ–ç›´æ¥ç·¨è¼¯ `backend/configs/network_config.json`

### æƒ³æ·»åŠ æ–°çš„ API ç«¯é»?
â†’ ç·¨è¼¯ `backend/app/api/frontend.py` æˆ– `backend/app/api/websocket.py`

### æƒ³ä¿®æ”¹è·é›¢è¨ˆç®—é‚è¼¯?
â†’ ç·¨è¼¯ `backend/app/services/calculator.py`

### æƒ³äº†è§£ API ä½¿ç”¨æ–¹å¼?
â†’ é–±è®€ `docs/åŸå§‹README.md` çš„ API ç«¯é»ç« ç¯€

### æƒ³éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ?
â†’ åƒè€ƒ `docs/å¿«é€Ÿå•Ÿå‹•.md` å’Œ `docs/åŸå§‹README.md`

## ğŸ¯ æª”æ¡ˆå¤§å°åƒè€ƒ

| é¡å‹ | æª”æ¡ˆ | å¤§å°åƒè€ƒ |
|------|------|----------|
| æ¨¡å‹ | `models/yolo11n.pt` | ~6 MB |
| è¨­å®š | `*.json` | <10 KB |
| ç¨‹å¼ç¢¼ | `*.py` | é€šå¸¸ <50 KB |
| æ–‡ä»¶ | `*.md` | é€šå¸¸ <100 KB |

## ğŸ“ æª”æ¡ˆå‘½åè¦ç¯„

- **Python æ¨¡çµ„**: å°å¯«è›‡å½¢ `module_name.py`
- **é¡åˆ¥**: å¤§é§å³° `ClassName`
- **å‡½å¼/è®Šæ•¸**: å°å¯«è›‡å½¢ `function_name`, `variable_name`
- **å¸¸æ•¸**: å¤§å¯«è›‡å½¢ `CONSTANT_NAME`
- **è¨­å®šæª”**: å°å¯«è›‡å½¢ `config_name.json`
- **æ–‡ä»¶**: ä¸­æ–‡æˆ–è‹±æ–‡,æ¸…æ¥šæè¿°å…§å®¹

## ğŸ”— ç›¸é—œé€£çµ

- [FastAPI æ–‡ä»¶](https://fastapi.tiangolo.com/)
- [Ultralytics YOLO æ–‡ä»¶](https://docs.ultralytics.com/)
- [OpenCV æ–‡ä»¶](https://docs.opencv.org/)

---

**æœ€å¾Œæ›´æ–°:** 2025-11-08  
**ç‰ˆæœ¬:** 1.0.0
