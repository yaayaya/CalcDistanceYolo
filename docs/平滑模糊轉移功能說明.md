# å¹³æ»‘æ¨¡ç³Šè½‰ç§»åŠŸèƒ½èªªæ˜

## å•é¡Œæè¿°
åœ¨åŸå§‹å¯¦ä½œä¸­,ç•¶äººç‰©æ¶ˆå¤±æˆ–åµæ¸¬å¤±éˆæ™‚,æ¨¡ç³Šæ•ˆæœæœƒ**ç«‹å³æ¶ˆå¤±**,å°è‡´ç•«é¢çªç„¶è®Šæ¸…æ™°,ç”¢ç”Ÿè·³èºæ„Ÿã€‚

## è§£æ±ºæ–¹æ¡ˆ

### 1. åµæ¸¬ç‹€æ…‹ç®¡ç†æ©Ÿåˆ¶
æ–°å¢ä¸‰å€‹ç‹€æ…‹è¿½è¹¤è®Šæ•¸:
- `lastValidDetectionTime`: æœ€å¾Œä¸€æ¬¡æœ‰æ•ˆåµæ¸¬çš„æ™‚é–“
- `isDetectionActive`: åµæ¸¬æ˜¯å¦è™•æ–¼å•Ÿç”¨ç‹€æ…‹
- `detectionLostTime`: åµæ¸¬å¤±æ•ˆçš„æ™‚é–“

### 2. å»¶é²æ©Ÿåˆ¶
åƒè€ƒ `blur_control` é…ç½®åƒæ•¸:
```json
{
  "activation_delay": 200,      // å•Ÿå‹•å»¶é² (æ¯«ç§’)
  "deactivation_delay": 750,    // åœç”¨å»¶é² (æ¯«ç§’)
  "movement_threshold": 5        // ç§»å‹•é–¾å€¼ (cm)
}
```

#### å•Ÿå‹•å»¶é² (Activation Delay)
- ç•¶åµæ¸¬åˆ°äººç‰©æ™‚,ä¸æœƒç«‹å³å•Ÿç”¨æ¨¡ç³Š
- éœ€ç­‰å¾… 200ms å¾Œæ‰é–‹å§‹å¥—ç”¨æ¨¡ç³Šæ•ˆæœ
- é¿å…çŸ­æš«èª¤åˆ¤é€ æˆé–ƒçˆ

#### åœç”¨å»¶é² (Deactivation Delay)
- ç•¶äººç‰©æ¶ˆå¤±æ™‚,ä¸æœƒç«‹å³æ¸…é™¤æ¨¡ç³Š
- æœƒä¿æŒç•¶å‰æ¨¡ç³Šç‹€æ…‹ 750ms
- ç„¶å¾Œæ‰é–‹å§‹å¹³æ»‘éæ¸¡å›æ¸…æ™°ç‹€æ…‹

### 3. æ¨¡ç³Šåƒæ•¸å¹³æ»‘éæ¸¡
å°æ‰€æœ‰æ¨¡ç³Šç›¸é—œåƒæ•¸é€²è¡Œæ’å€¼å¹³æ»‘:

```javascript
// å¹³æ»‘é€Ÿåº¦é…ç½®
let BLUR_SMOOTH_SPEED = 0.12;  // 12% çš„é€Ÿåº¦é€æ¼¸éæ¸¡

// Canvas Filter æ¨¡ç³ŠåŠå¾‘å¹³æ»‘
currentBlurRadius += (targetBlurRadius - currentBlurRadius) * BLUR_SMOOTH_SPEED;

// æ¨¡ç³Šåœ–å±¤é€æ˜åº¦å¹³æ»‘
currentOpacity += (targetOpacity - currentOpacity) * BLUR_SMOOTH_SPEED;
```

### 4. é‹ä½œæµç¨‹

#### æƒ…å¢ƒ A: äººç‰©å‡ºç¾
1. æ¥æ”¶åˆ°æœ‰æ•ˆè·é›¢è³‡æ–™ (distance > 0, count > 0)
2. è¨˜éŒ„ `lastValidDetectionTime`
3. æª¢æŸ¥æ˜¯å¦å·²è¶…é `ACTIVATION_DELAY`
4. å•Ÿç”¨åµæ¸¬ â†’ è¨­å®š `targetDistance`
5. å¹³æ»‘éæ¸¡ `smoothedDistance`
6. å¹³æ»‘éæ¸¡ `currentBlurRadius` å’Œ `currentOpacity`

#### æƒ…å¢ƒ B: äººç‰©æ¶ˆå¤±
1. æ¥æ”¶åˆ°ç„¡æ•ˆè³‡æ–™ (distance = 0 æˆ– count = 0)
2. è¨ˆç®—è·é›¢ä¸Šæ¬¡æœ‰æ•ˆåµæ¸¬çš„æ™‚é–“
3. å¦‚æœ < `DEACTIVATION_DELAY`: **ä¿æŒç•¶å‰ç›®æ¨™è·é›¢**
4. å¦‚æœ â‰¥ `DEACTIVATION_DELAY`: è¨­å®š `targetDistance = 0`
5. å¹³æ»‘éæ¸¡å›æ¸…æ™°ç‹€æ…‹

#### æƒ…å¢ƒ C: äººç‰©å¿«é€Ÿç§»å‹•
1. è·é›¢è®ŠåŒ–è¶…é `DISTANCE_CHANGE_THRESHOLD`
2. ä½¿ç”¨è¼ƒå¿«çš„ `DISTANCE_SMOOTH_SPEED` è¿½è¹¤
3. æ¨¡ç³Šåƒæ•¸ä½¿ç”¨ `BLUR_SMOOTH_SPEED` å¹³æ»‘è®ŠåŒ–

## åƒæ•¸èª¿æ•´æŒ‡å—

### èª¿æ•´å»¶é²æ™‚é–“
åœ¨ `backend/configs/project_config.json`:
```json
{
  "blur_control": {
    "activation_delay": 200,      // å¢åŠ  = æ›´æ…¢å•Ÿå‹• (é¿å…é–ƒçˆ)
    "deactivation_delay": 750,    // å¢åŠ  = æ›´æ…¢æ¢å¾© (æ›´æŸ”å’Œ)
    "movement_threshold": 5
  }
}
```

**å»ºè­°å€¼**:
- å¿«é€Ÿåæ‡‰: `activation_delay: 100`, `deactivation_delay: 500`
- æ¨™æº–åæ‡‰: `activation_delay: 200`, `deactivation_delay: 750` (é è¨­)
- æŸ”å’Œåæ‡‰: `activation_delay: 300`, `deactivation_delay: 1000`

### èª¿æ•´å¹³æ»‘é€Ÿåº¦
åœ¨ç¨‹å¼ç¢¼ä¸­ä¿®æ”¹ (æœªä¾†å¯åŠ å…¥é…ç½®):
```javascript
let BLUR_SMOOTH_SPEED = 0.12;     // æ¨¡ç³Šåƒæ•¸å¹³æ»‘é€Ÿåº¦
let DISTANCE_SMOOTH_SPEED = 0.15; // è·é›¢å¹³æ»‘é€Ÿåº¦
```

**é€Ÿåº¦å°ç…§**:
- `0.05`: éå¸¸ç·©æ…¢ (éœ€è¦ ~20 å¹€éæ¸¡)
- `0.12`: å¹³æ»‘æŸ”å’Œ (éœ€è¦ ~8 å¹€éæ¸¡) âœ… æ¨è–¦
- `0.20`: è¼ƒå¿«é€Ÿ (éœ€è¦ ~5 å¹€éæ¸¡)
- `0.50`: å¿«é€Ÿ (éœ€è¦ ~2 å¹€éæ¸¡)
- `1.00`: ç«‹å³ (ç„¡éæ¸¡)

## é™¤éŒ¯è³‡è¨Š

é–‹å•Ÿé™¤éŒ¯æ¨¡å¼ (Ctrl+Shift+D) å¯çœ‹åˆ°:

```
è·é›¢: 85.3 â†’ 83.7 cm ğŸŸ¢ å•Ÿç”¨
åµæ¸¬æ•¸: 1
æ¨¡ç³Š: 8.2 px (ç›®æ¨™: 8.5)
é€æ˜åº¦: 24.5% (ç›®æ¨™: 25.0%)
```

ç‹€æ…‹æŒ‡ç¤ºå™¨:
- ğŸŸ¢ å•Ÿç”¨: æ­£åœ¨è¿½è¹¤äººç‰©
- âšª å¾…æ©Ÿ: ç­‰å¾…å»¶é²æˆ–ç„¡åµæ¸¬

## æ¸¬è©¦å ´æ™¯

### 1. äººç‰©æ¶ˆå¤±æ¸¬è©¦
1. é–‹å•Ÿ `http://localhost:8000/flur.html`
2. ç«™åœ¨æ”å½±æ©Ÿå‰ (è·é›¢ 60-80cm)
3. ç­‰å¾…æ¨¡ç³Šæ•ˆæœå®Œå…¨å¥—ç”¨
4. å¿«é€Ÿé›¢é–‹ç•«é¢
5. **é æœŸ**: æ¨¡ç³Šæ•ˆæœä¿æŒ 750ms å¾Œæ‰é–‹å§‹å¹³æ»‘æ¶ˆå¤±

### 2. å¿«é€Ÿé€²å‡ºæ¸¬è©¦
1. åœ¨ç•«é¢é‚Šç·£å¿«é€Ÿé€²å‡º
2. **é æœŸ**: ä¸æœƒé–ƒçˆ,æœ‰ 200ms çš„å•Ÿå‹•ç·©è¡

### 3. è·é›¢è®ŠåŒ–æ¸¬è©¦
1. æ…¢æ…¢æ¥è¿‘/é é›¢æ”å½±æ©Ÿ
2. **é æœŸ**: æ¨¡ç³Šåº¦å¹³æ»‘è®ŠåŒ–,ç„¡è·³èº

### 4. åµæ¸¬å¤±éˆæ¸¬è©¦
1. ä½¿ç”¨é®æ“‹ç‰©çŸ­æš«é®è”½
2. **é æœŸ**: 750ms å…§æ¢å¾©åµæ¸¬ä¸æœƒæ¸…é™¤æ¨¡ç³Š

## æ•ˆèƒ½å½±éŸ¿

- **CPU**: å¹¾ä¹ç„¡å½±éŸ¿ (åƒ…å¢åŠ ç°¡å–®çš„æ•¸å­¸é‹ç®—)
- **GPU**: ç„¡å½±éŸ¿ (ä»ä½¿ç”¨ç›¸åŒçš„ Canvas Filter)
- **è¨˜æ†¶é«”**: å¢åŠ  ~100 bytes (æ–°å¢è®Šæ•¸)
- **FPS**: ç„¡æ˜é¡¯è®ŠåŒ–

## èˆ‡å…¶ä»–åŠŸèƒ½çš„æ•´åˆ

### Canvas Filter
- å®Œå…¨ç›¸å®¹
- æ¨¡ç³ŠåŠå¾‘å¹³æ»‘éæ¸¡
- å™ªé»å¼·åº¦è·Ÿéš¨è·é›¢è®ŠåŒ–

### Blur Overlay
- å®Œå…¨ç›¸å®¹
- é€æ˜åº¦å’Œæ¨¡ç³ŠåŠå¾‘åŒæ™‚å¹³æ»‘
- å¤šå±¤åœ–å±¤åŒæ­¥éæ¸¡

### å‹•æ…‹è§£æåº¦
- ç¨ç«‹é‹ä½œ
- ä¸å—è·é›¢å¹³æ»‘å½±éŸ¿
- å¯åŒæ™‚å•Ÿç”¨

## æ³¨æ„äº‹é …

1. **å»¶é²ä¸å®œéé•·**: `deactivation_delay` éå¤§æœƒè®“ä½¿ç”¨è€…æ„Ÿè¦ºåæ‡‰é²éˆ
2. **å¹³æ»‘é€Ÿåº¦å¹³è¡¡**: éæ…¢æœƒæ‹–æ³¥å¸¶æ°´,éå¿«æœƒå¤±å»å¹³æ»‘æ•ˆæœ
3. **æ­é… easing å‡½æ•¸**: å»ºè­°ä½¿ç”¨ `ease-out` è®“è®ŠåŒ–æ›´è‡ªç„¶

## æœªä¾†å„ªåŒ–æ–¹å‘

1. å°‡ `BLUR_SMOOTH_SPEED` åŠ å…¥é…ç½®æª”
2. æ”¯æ´ä¸åŒçš„æ’å€¼æ›²ç·š (cubic, exponential)
3. æ ¹æ“šè·é›¢è®ŠåŒ–é€Ÿåº¦å‹•æ…‹èª¿æ•´å¹³æ»‘é€Ÿåº¦
4. åŠ å…¥é æ¸¬æ€§ç®—æ³• (é æ¸¬äººç‰©ç§»å‹•æ–¹å‘)
